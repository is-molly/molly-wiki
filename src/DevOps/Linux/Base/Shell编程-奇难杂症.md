---
order: 2
date: 2024-06-02
---

# Shell编程-奇难杂症

## 状态码

### 脚本或函数结尾处的&&与||

方式一：

```bash
#!/bin/bash

a=1
if [ $a -ne 1 ];then
  echo '[error]'
fi
```

方式二：

```bash
#!/bin/bash

a=1
[ $a -ne 1 ] && echo '[error]'
```

从代码想要达到的效果上，两种方式一致。但是执行脚本后，使用`echo $?`检查代码执行状态码会发现，方式一输出的是0，方式二输出的是1！

结论：

- 在 aa && bb 这种组合命令中，$? 保存的是最后一个实际执行命令的状态码
- 脚本或函数结尾处慎用&&与||，由于$?可能会导致结束状态码与预期不一致！